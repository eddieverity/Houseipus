
<script type="text/javascript" language="JavaScript">
function HidePart(d) { document.getElementById(d).style.display = "none";  }
function ShowPart(d) { document.getElementById(d).style.display = "block"; }
function CheckboxChecked(b,d)
{
   if(b) { ShowPart(d); }
   else  { HidePart(d); }
}
</script>

<div class="container usershow">
    <div class="signins well">
      <h3>Personal Details</h3>
      




      <table class="table">
        <tr>
          <td>Email:</td>
          <td><%= @user.email %></td>
        </tr>
        <% if @user.agent != nil %>
        <tr>
          <td>Agent Type:</td>
          <td><%= @user.agent %></td>
        </tr>
        <tr>
          <td>Name:</td>
          <td><%= @user.first_name.capitalize %> <%= @user.last_name.capitalize %></td>
        </tr>
        <tr>
          <td>Zip Code:</td>
          <td><%= @user.addr %></td>
        </tr>
        <tr>
          <td>Phone:</td>
          <td><%= @user.phone %></td>
        </tr>
        <% end %>
      </table>




      <% if @user.id == session[:user_id] %>
        <form action="/users/edit/<%= @user.id %>" method="GET">
          <input type="submit" value="Edit User Details" class="btn btn-primary">
        </form>
      <% else %>
        <form action="/messages/contact/<%= @user.id %>/<%= session[:user_id] %>" method="GET">
          <input type="submit" value="Contact This User" class="btn btn-primary">
        </form>
      <% end %>
    </div>
    <% if @user.agent != nil %> 
      <div class="signins well">
        <h3>Sale Listings</h3>
        <ul>
          <% if @sale_listings.length > 0 %>
            <% @sale_listings.each do |s| %>
              <li><a href="/listings/sale/<%= s.id %>"><%= s.address %> <%= s.street %> <%= s.city %></a></li>
            <% end %>
          <% else %>
            <li>No current listings</li>
          <% end %>
        </ul>
        <h3>Rental Listings</h3>
        <ul>
          <% if @rental_listings.length > 0 %>
            <% @rental_listings.each do |r| %>
              <li><a href="/listings/rent/<%= r.id %>"><%= r.address %> <%= r.street %> <%= r.city %></a></li>
            <% end %>
          <% else %>
            <li>No current listings</li>
          <% end %>
        </ul>


      </div>      
    <% end %>

    <% if @favorite_rentals != nil or @favorite_sales != nil %>
      <div class="signins well">
        <h3>Favorite Listings</h3>
          <ul>
            <li>Rentals</li>
                <% if @favorite_rentals.length > 0 %>
                  <ul>
                    <% @favorite_rentals.each do |f| %>
                      <li><a href="/listings/rent/<%=f.rental_listing_id%>">
                        <%= f.rental_listing.address %>
                        <%= f.rental_listing.street %>
                        <%= f.rental_listing.city %>
                      </a></li>
                    <% end %>
                  </ul>
                <% else %>
                  <ul>
                    <li>No Rental Listings favorited</li>
                  </ul>
                <% end %>

            <li>For Sale</li>

              <% if @favorite_sales.length > 0 %>
                <ul>
                  <% @favorite_sales.each do |s| %>
                  
                    <li><a href="/listings/sale/<%=s.sale_listing_id%>">
                      <%= s.sale_listing.address %>
                      <%= s.sale_listing.street %>
                      <%= s.sale_listing.city %>
                    </a></li>
                  <% end %>
                </ul>
              <% else %>
                <ul>
                  <li>No Sale Listings favorited</li>
                </ul>
              <% end %>
          </ul>
      </div>
    <% end %>



  <% if @user.id == session[:user_id] %>
    <div class="signins">
    <div class="well contents message_contents">
      <h3><a href="/messages/show/<%= session[:user_id] %>">Messages</a></h3>
          <ul>
            <% if @inbox.length > 0 %>
              <h4 class="inoutbox">Inbox</h4>
                  <table class="table table-hover">
                    <tr>
                      <th>Title</th>
                      <th>Received from</th>
                    </tr>
                  <% @inbox.each do |i| %>
                    <tr>
                      <td>                       
                      <form class="message_buttons" action="/messages/viewed/<%= i.id %>" method="POST">
                          <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
                          <input type="submit" value="<%= i.title.truncate(12) %>" class="btn btn-info btn-sm" 
                            <% if i.viewed == false %>
                              style="background-color:red;" 
                            <% end %>
                          data-toggle="modal" data-target="#myModali<%= i.id%>">
                      </form>
                      <div class="modal fade" id="myModali<%= i.id %>" role="dialog">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="close" data-dismiss="modal">&times;</button>
                              <h4 class="modal-title">Title: <%= i.title %></h4>
                            </div>
                            <div class="modal-body">
                              <p>Message: <%= i.content %></p>
                              <hr>
                              <p><a href="/messages/contact/<%= i.sender_id%>/<%= i.receiver_id %>">Reply</a></p>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-default" data-dismiss="modal" onClick="window.location.reload()">Close</button>
                            </div>
                          </div>     
                        </div>
                      </div>
                      </td>
                      <td>
                        <a href="/messages/contact/<%= i.sender.id %>/<%= session[:user_id] %>"><%= i.sender.email %></a>
                      </td>
                    </tr>
                  <% end %>
              </table>
                
            <% end %>



            <% if @outbox.length > 0 %>
              <h4 class="inoutbox">Outbox</h4>
                <table class="table table-hover">
                  <tr>
                    <th>Title</th>
                    <th>Sent To</th>
                  </tr>
                  <% @outbox.each do |o| %>
                  <tr>
                    <td>
                      <button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#myModalo<%= o.id %>"
                        <% if o.viewed == false %>
                          style="background-color:red;" 
                        <% end %>
                        ><%= o.title.truncate(12) %>
                      </button>
                      <div class="modal fade" id="myModalo<%= o.id %>" role="dialog">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <button type="button" class="close"  data-dismiss="modal">&times;</button>
                              <h4 class="modal-title">Title: <%= o.title %></h4>
                            </div>
                            <div class="modal-body">
                              <p>Message: <%= o.content %></p>
                              <hr>
                              <p><a href="/messages/contact/<%= o.receiver_id%>/<%= o.sender_id %>">Reply</a></p>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                          </div> 
                        </div>
                      </div>
                    </td>
                    <td>
                      <a href="/messages/contact/<%= o.receiver.id %>/<%= session[:user_id] %>"><%= o.receiver.email %></a>
                    </td>
                  </tr>
                  <% end %>
                </table>
            <% end %>
          </ul>
    </div>
    </div>

  <% end %>



    <div class="signinimage"></div>
</div>